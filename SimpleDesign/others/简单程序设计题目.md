# Rust è¯¾ç¨‹æˆç»©ç®¡ç†ç³»ç»Ÿè®¾è®¡é¢˜
---
## ğŸ“š æ¶‰åŠçš„ Rust çŸ¥è¯†ç‚¹ç®€è¦æ€»ç»“

- **ç»“æ„ä½“ï¼ˆ`struct`ï¼‰**ï¼šç”¨äºå®šä¹‰å­¦ç”Ÿæ•°æ®ç±»å‹ã€‚

- **æšä¸¾ï¼ˆ`enum`ï¼‰**ï¼šç”¨äºè¡¨ç¤ºå›ºå®šè¯¾ç¨‹ï¼ˆç§‘ç›®ï¼‰ã€‚

- **æ–¹æ³•å®ç°ï¼ˆ`impl`ï¼‰**ï¼šä¸ºç»“æ„ä½“å®ç°å¦‚å¹³å‡æˆç»©ç­‰æ–¹æ³•ã€‚

- **æ–‡ä»¶è¯»å–ä¸ CSV è§£æ**ï¼šä½¿ç”¨ `serde` å’Œ `csv` åº“å¤„ç†æ–‡ä»¶è¾“å…¥ã€‚

- **æ‰€æœ‰æƒä¸å€Ÿç”¨**ï¼šä¼ é€’å’Œæ“ä½œ `Vec<Student>` æ—¶éœ€æŒæ¡å¼•ç”¨è¯­ä¹‰ã€‚

- **é”™è¯¯å¤„ç†ï¼ˆ`Result`, `Option`ï¼‰**ï¼šç”¨äºå¤„ç†æ–‡ä»¶è¯»å–å’ŒæŸ¥æ‰¾æ“ä½œä¸­çš„å¼‚å¸¸æƒ…å†µã€‚

- **æ’åºä¸æŸ¥æ‰¾**ï¼šæŒ‰å¹³å‡æˆç»©æ’åºï¼ŒæŸ¥æ‰¾æœ€é«˜åˆ†åŠå…¶ç§‘ç›®ã€‚

- **æ¨¡å¼åŒ¹é…ï¼ˆ`match`ï¼‰**ï¼šåŒ¹é…æšä¸¾å€¼æ‰§è¡Œå¯¹åº”é€»è¾‘ã€‚


## é¢˜ç›®æè¿°

è®¾è®¡ä¸€ä¸ªå›ºå®šç§‘ç›®ï¼ˆæ•°å­¦ã€è¯­æ–‡ã€è‹±è¯­ã€ç‰©ç†ã€åŒ–å­¦ï¼‰çš„å­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿï¼Œå®ç°å¯¹å­¦ç”Ÿæˆç»©çš„è¯»å–ã€ç»Ÿè®¡å’Œæ’åºåˆ†æã€‚==markdown æ ¼å¼å†…å®¹å·²ä¸Šä¼ è‡³ [github](https://github.com/169LI/rust-henu/tree/master/SimpleDesign/others)==


## 1ã€éƒ¨åˆ†å­—æ®µ

-  å®šä¹‰å­¦ç”Ÿç»“æ„ä½“
```rust
use serde::Deserialize;

#[derive(Debug, Deserialize)]
struct Student {
    id: u32,
    name: String,
    math: f32,
    chinese: f32,
    english: f32,
    physics: f32,
    chemistry: f32,
}
```

- ç§‘ç›®æšä¸¾ï¼š

```rust
enum Subject {
    Math,
    Chinese,
    English,
    Physics,
    Chemistry,
}
```
## 2ã€åŠŸèƒ½è¦æ±‚åŠå‡½æ•°ç­¾å

åŠŸèƒ½ä¸å¯æ›´æ”¹ï¼Œå‡½æ•°ç­¾åå¯æ ¹æ®å…·ä½“çš„å®ç°è¿›è¡Œæ›´æ”¹
### 2.1 åŸºäº `impl Student` çš„æ–¹æ³•

#### 2.1.1 è®¡ç®—å•ä¸ªå­¦ç”Ÿçš„å¹³å‡æˆç»©ï¼š

```Rust
impl Student {  
		fn average_score(&self) -> f32;
 }
```

#### 2.1.2 æ ¹æ®ç§‘ç›®è·å–è¯¥å­¦ç”Ÿå¯¹åº”æˆç»©ï¼š

```Rust
impl Student {     
		fn score_by_subject(&self, subject: Subject) -> f32; 
}
```

### 2.2 ç‹¬ç«‹å‡½æ•°

#### 2.2.1 ä»  CSV  æ–‡ä»¶è¯»å–å­¦ç”Ÿæ•°æ®

```rust
fn read_students_from_csv<P: AsRef<std::path::Path>>(path: P) -> Result<Vec<Student>, Error>
```

- å¯ä½¿ç”¨å­¦ä¹ è¿‡çš„ `serdeåº“` æ´¾ç”Ÿè‡ªåŠ¨è§£æ CSV çš„æ–‡ä»¶ï¼Œè¿”å›æ‰€æœ‰å­¦ç”Ÿæ•°æ®ã€‚
#### 2.2.2 è®¡ç®—å•ä¸ªå­¦ç”Ÿçš„å¹³å‡æˆç»©

```rust
fn average_score(student: &Student) -> f32
```

#### 2.2.3 å®šä¹‰ç§‘ç›®æšä¸¾

```rust
enum Subject {
    Math,
    Chinese,
    English,
    Physics,
    Chemistry,
}
```

#### 2.2.4 è®¡ç®—æŸé—¨è¯¾ç¨‹çš„å…¨ç­å¹³å‡æˆç»©

```rust
fn course_average(students: &[Student], subject: Subject) -> f32
```
- subject: Subjectè¯¥å‚æ•°ä¸å¯æ›´æ¢ï¼Œä½¿ç”¨æšä¸¾ç±»å‹ä¼ å‚
---

#### 2.2.5 æŸ¥æ‰¾å…¨ç­æœ€é«˜åˆ†åŠå¯¹åº”å­¦ç”Ÿå’Œç§‘ç›®

```rust
fn top_score(students: &[Student]) -> Option<(&Student, Subject, f32)>
```

---

#### 2.2.6 æŒ‰å­¦ç”Ÿå¹³å‡æˆç»©ä»é«˜åˆ°ä½æ’åºï¼Œå¹¶æ‰“å°ã€‚

```rust
fn sort_students_by_average(students: &mut [Student])
```

---

## æ¨¡æ‹Ÿæ•°æ®ç¤ºä¾‹ (å¯è‡ªå®šä¹‰)

```csv
id,name,math,chinese,english,physics,chemistry
1001,å¼ ä¸‰,88,84.5,91,90,85
1002,æå››,95,89,92.5,98,92
1003,ç‹äº”,80,78.5,82,85,85.5
1004,èµµå…­,91,87,89,88,90
1005,é’±ä¸ƒ,85,83,87,84,88
1006,å­™å…«,78,80,75,82,79
1007,å‘¨ä¹,92,90,94,91,93
```


## 3ã€æµ‹è¯•

è‡ªè¡Œä¹¦å†™æµ‹è¯•ä»£ç ï¼Œå¯¹ä¸Šè¿°é‡è¦å‡½æ•°é€ä¸€è¿›è¡Œæµ‹è¯•ã€‚ï¼ˆä¸æ˜¯å†™ä¸€ä¸ª main æµ‹è¯•å®Œæ•´åŠŸèƒ½ï¼Œæ˜¯å†™ test å»å¯¹æ¯ä¸€ä¸ªåŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼‰

ç¤ºä¾‹ï¼š

```rust
#[cfg(test)]

mod tests {
	use super::*;
	
	// Helper function to create a sample student for testing
    fn create_test_student() -> Student {       //ä¹Ÿå¯ä»¥åœ¨`impl Student`ä¸­å†™ä¸€ä¸ªnew(),è¿™æ ·è¿™ä¸ªå°±ä¸ç”¨å†™äº†
        Student {
            id: 1001,
            name: String::from("å¼ ä¸‰"),
            math: 88.0,
            chinese: 84.5,
            english: 91.0,
            physics: 90.0,
            chemistry: 85.0,
        }
    }
    
#[test]
    fn test_sort_students_by_average() {
        let mut students = vec![
            create_test_student(),
            Student {
                id: 1002,
                name: String::from("ç‹éº»å­"),
                math: 95.0,
                chinese: 89.0,
                english: 92.5,
                physics: 98.0,
                chemistry: 92.0,
            },
        ];
        sort_students_by_average(&mut students);
        // ç‹éº»å­'s average: (95 + 89 + 92.5 + 98 + 92) / 5 = 93.3
        // å¼ ä¸‰'s average: (88 + 84.5 + 91 + 90 + 85) / 5 = 87.7
        assert_eq!(students[0].id, 1002); // Higher average first
        assert_eq!(students[1].id, 1001);
    }
}
    
